
{% load static %}
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>九章後台管理系統 - 學生資料列表</title>
    
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link rel="stylesheet" href="{% static 'css/app.css' %}">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
</head>

<style>
    body {
        /* 將字體套用到整個 body */
        font-family: "Noto Sans TC", "PingFang TC", "Microsoft JhengHei", Arial, sans-serif;
    }

    /* 針對手機用戶：當螢幕寬度小於 768px (md:斷點) 時，隱藏側邊欄 */
    @media (max-width: 767px) {
        .mobile-hidden-sidebar {
            /* 預設隱藏側邊欄，需要 JS 來切換顯示 */
            /* 在此範例中，我們先保持簡單，直接在小螢幕上將側邊欄固定寬度 */
            /* 實際應用中，通常會使用 Tailwind 的 'hidden' 和 'md:flex' */
        }
    }
</style>

<body class="bg-gray-50 text-gray-800">
    <div class="flex h-screen overflow-hidden">

        <aside id="sidebar" 
            class="fixed inset-y-0 left-0 z-40 w-64 flex-shrink-0 bg-blue-600 h-full flex flex-col justify-between p-4 border-r border-gray-300
                    transition-transform duration-300 ease-in-out transform -translate-x-full md:translate-x-0 md:relative md:flex">            <nav class="space-y-1">
                <div class="flex items-center justify-center space-x-3 mb-10 pb-4 border-b border-blue-500/50">
                    <img src="{% static 'img/logo_jiuzhang.png' %}" alt="九章 Logo" class="h-10 w-auto object-cover">
                    <span class="text-2xl font-extrabold tracking-wider text-white">後台</span>
                </div>
                
                <a href="{% url 'student_list' %}" class="flex items-center space-x-3 p-2 rounded-lg 
                  bg-indigo-100 text-indigo-700 font-semibold">
                  <span>學生資訊</span>
                </a>

                <a href="#" class="flex items-center space-x-3 p-2 rounded-lg text-white hover:bg-blue-500/70">
                    <span>課程管理</span>
                </a>
                
                </nav>
            
            <div>
                </div>
            
        </aside>

        <main class="flex-1 flex flex-col overflow-y-auto">

            <header class="h-16 flex-shrink-0 border-b border-gray-200 bg-white shadow-sm p-4 flex items-center justify-center relative">
    
                <button id="sidebar-toggle" class="absolute left-4 text-gray-500 hover:text-gray-900 md:hidden">
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>

                <h1 class="text-xl font-semibold text-gray-900">學生資訊管理</h1>
                
                <div class="absolute right-4 md:hidden">
                    </div>
            </header>
            <div class="flex-1 p-4 md:p-6">
                
                <div class="container mx-auto"> 
                                <div class="mb-6 flex justify-end">
                                    <a href="{% url 'student_add' %}" class="inline-block bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition duration-150 shadow-md text-base">
                                        新增學生資料
                                    </a>
                                </div>


                                <div class="hidden md:block shadow-lg rounded-lg overflow-hidden">
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full bg-white">
                                            <thead class="bg-blue-600 border-b border-gray-300">
                                                <tr>
                                                    <th class="py-3 px-4 text-left text-sm font-semibold text-white">姓名</th>
                                                    <th class="py-3 px-4 text-left text-sm font-semibold text-white">學校/年級</th>
                                                    <th class="py-3 px-4 text-left text-sm font-semibold text-white hidden lg:table-cell">聯絡方式</th>
                                                    <th class="py-3 px-4 text-left text-sm font-semibold text-white hidden xl:table-cell">備註</th>
                                                    <th class="py-3 px-4 text-center text-sm font-semibold text-white">操作</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {% for student in students %}
                                                <tr class="border-b hover:bg-gray-50 transition duration-100">
                                                    <td class="py-3 px-4 text-sm font-medium text-gray-900">{{ student.name }}</td>
                                                    <td class="py-3 px-4 text-sm text-gray-600">{{ student.school }} / {{ student.grade }}</td>
                                                    <td class="py-3 px-4 text-sm text-gray-600 hidden lg:table-cell">{{ student.contact }}</td>
                                                    <td class="py-3 px-4 text-sm text-gray-600 truncate max-w-xs hidden xl:table-cell">{{ student.notes }}</td>
                                                    <td class="py-3 px-4 text-center whitespace-nowrap">
                                                        <a href="{% url 'student_update' student.id %}" class="bg-blue-500 text-white px-3 py-1 text-xs rounded-full hover:bg-blue-600 mr-2">編輯</a>
                                                        <form action="{% url 'student_delete' student.id %}" method="post" class="inline-block">
                                                            {% csrf_token %}
                                                            <button type="submit" 
                                                                    class="bg-red-500 text-white px-3 py-1 text-xs rounded-full hover:bg-red-600"
                                                                    onclick="return confirm('確定要刪除學生 {{ student.name }} 的資料嗎？')">
                                                                刪除
                                                            </button>
                                                        </form>
                                                    </td>
                                                </tr>
                                                {% empty %}
                                                <tr>
                                                    <td colspan="5" class="py-4 px-4 text-center text-gray-500">目前沒有學生資料。</td>
                                                </tr>
                                                {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>


                                <div class="md:hidden space-y-4">
                                    {% for student in students %}
                                    <div class="bg-white rounded-lg shadow-lg p-4 border border-gray-200">
                                        
                                        <div class="flex items-center justify-between border-b pb-2 mb-2">
                                            <div class="flex-1">
                                                <p class="text-xl font-bold text-indigo-700">{{ student.name }}</p>
                                                <p class="text-sm text-gray-500">{{ student.school }} / {{ student.grade }}</p>
                                            </div>
                                            
                                            <div class="flex space-x-2 flex-shrink-0">
                                                <a href="{% url 'student_update' student.id %}" class="bg-blue-500 text-white p-2 text-xs rounded-full hover:bg-blue-600">
                                                    <svg class="h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/></svg>
                                                </a>
                                                
                                                <form action="{% url 'student_delete' student.id %}" method="post" class="inline-block">
                                                    {% csrf_token %}
                                                    <button type="submit" 
                                                            class="bg-red-500 text-white p-2 text-xs rounded-full hover:bg-red-600"
                                                            onclick="return confirm('確定刪除 {{ student.name }} 的資料嗎？')">
                                                        <svg class="h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>
                                                    </button>
                                                </form>
                                            </div>
                                        </div>

                                        <div class="space-y-1 text-sm">
                                            <p class="text-gray-700">
                                                <span class="font-medium text-gray-500 w-24 inline-block">聯絡方式:</span> 
                                                {{ student.contact }}
                                            </p>
                                            <p class="text-gray-700">
                                                <span class="font-medium text-gray-500 w-24 inline-block">備註:</span> 
                                                {{ student.notes|default:"無" }}
                                            </p>
                                        </div>
                                    </div>
                                    {% empty %}
                                    <div class="py-4 text-center text-gray-500 bg-white rounded-lg shadow-md">目前沒有學生資料。</div>
                                    {% endfor %}
                                </div>
                                
                            </tbody>
                        </table>
                    </div>
                    </div>
                </div>
            </main>
        </div>
        </div>
    
    <div id="sidebar-overlay" 
         class="fixed inset-0 z-30 bg-black opacity-0 pointer-events-none transition-opacity duration-300 md:hidden">
    </div>

    <script>
        const sidebar = document.getElementById('sidebar');
        const toggleButton = document.getElementById('sidebar-toggle');
        const overlay = document.getElementById('sidebar-overlay');

        // 函式：切換側邊欄狀態
        function toggleSidebar() {
            // 檢查側邊欄是否有 -translate-x-full 類別
            const isClosed = sidebar.classList.contains('-translate-x-full');

            if (isClosed) {
                // 開啟側邊欄 (移除滑出/添加滑入)
                sidebar.classList.remove('-translate-x-full');
                sidebar.classList.add('translate-x-0');
                
                // 顯示遮罩
                overlay.classList.remove('opacity-0', 'pointer-events-none');
                overlay.classList.add('opacity-50');

            } else {
                // 關閉側邊欄 (移除滑入/添加滑出)
                sidebar.classList.remove('translate-x-0');
                sidebar.classList.add('-translate-x-full');

                // 隱藏遮罩
                overlay.classList.remove('opacity-50');
                overlay.classList.add('opacity-0', 'pointer-events-none');
            }
        }

        // 綁定事件
        // 注意：你需要確保你的 HTML 中有 sidebar 和 sidebar-toggle 的 ID！
        if (toggleButton) {
            toggleButton.addEventListener('click', toggleSidebar);
        }
        if (overlay) {
            overlay.addEventListener('click', toggleSidebar);
        }
    </script>
</body>
</html>